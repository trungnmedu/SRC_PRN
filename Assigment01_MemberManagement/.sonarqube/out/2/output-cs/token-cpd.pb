˙é
íE:\FPTU\PhongNT-FPTU-Learning-Resources\2021_Semester5_SUMMER\PRN211\Code Project\Assignments\Assigment01_MemberManagement\DataAccess\MemberDAO.cs
	namespace 	

DataAccess
 
{		 
public

 

class

 
	MemberDAO

 
{ 
private 
MemberObject 
GetDefaultMember -
(- .
). /
{ 	
MemberObject 
Default  
=! "
null# '
;' (
using 
( 
StreamReader 
r  !
=" #
new$ '
StreamReader( 4
(4 5
$str5 G
)G H
)H I
{ 
string 
json 
= 
r 
.  
	ReadToEnd  )
() *
)* +
;+ ,
IConfiguration 
config %
=& '
new( + 
ConfigurationBuilder, @
(@ A
)A B
.( )
SetBasePath) 4
(4 5
	Directory5 >
.> ?
GetCurrentDirectory? R
(R S
)S T
)T U
.( )
AddJsonFile) 4
(4 5
$str5 G
,G H
trueI M
,M N
trueO S
)S T
.( )
Build) .
(. /
)/ 0
;0 1
string 
email 
= 
config %
[% &
$str& D
]D E
;E F
string 
password 
=  !
config" (
[( )
$str) J
]J K
;K L
Default 
= 
new 
MemberObject *
{ 
MemberID 
= 
$num  
,  !
Email 
= 
email !
,! "
Password 
= 
password '
,' (
City 
= 
$str 
, 
Country 
= 
$str  
,  !

MemberName   
=    
$str  ! (
}!! 
;!! 
}"" 
return$$ 
Default$$ 
;$$ 
}%% 	
private(( 
static(( 
List(( 
<(( 
MemberObject(( (
>((( )
members((* 1
=((2 3
new((4 7
List((8 <
<((< =
MemberObject((= I
>((I J
{)) 	
new** 
MemberObject** 
{++ 
MemberID,, 
=,, 
$num,, 
,,, 

MemberName-- 
=-- 
$str-- '
,--' (
Email.. 
=.. 
$str.. )
,..) *
Password// 
=// 
$str// #
,//# $
City00 
=00 
$str00 #
,00# $
Country11 
=11 
$str11 )
}22 
,22 
new33 
MemberObject33 
{44 
MemberID55 
=55 
$num55 
,55 

MemberName66 
=66 
$str66 )
,66) *
Email77 
=77 
$str77 -
,77- .
Password88 
=88 
$str88 #
,88# $
City99 
=99 
$str99 
,99 
Country:: 
=:: 
$str:: #
};; 
,;; 
new<< 
MemberObject<< 
{== 
MemberID>> 
=>> 
$num>> 
,>> 

MemberName?? 
=?? 
$str?? &
,??& '
Email@@ 
=@@ 
$str@@ 4
,@@4 5
PasswordAA 
=AA 
$strAA #
,AA# $
CityBB 
=BB 
$strBB "
,BB" #
CountryCC 
=CC 
$strCC )
}DD 
,DD 
newEE 
MemberObjectEE 
{FF 
MemberIDGG 
=GG 
$numGG 
,GG 

MemberNameHH 
=HH 
$strHH &
,HH& '
EmailII 
=II 
$strII +
,II+ ,
PasswordJJ 
=JJ 
$strJJ #
,JJ# $
CityKK 
=KK 
$strKK 
,KK 
CountryLL 
=LL 
$strLL !
}MM 
,MM 
newNN 
MemberObjectNN 
{OO 
MemberIDPP 
=PP 
$numPP 
,PP 

MemberNameQQ 
=QQ 
$strQQ #
,QQ# $
EmailRR 
=RR 
$strRR (
,RR( )
PasswordSS 
=SS 
$strSS #
,SS# $
CityTT 
=TT 
$strTT 
,TT  
CountryUU 
=UU 
$strUU *
}VV 
,VV 
newWW 
MemberObjectWW 
{XX 
MemberIDYY 
=YY 
$numYY 
,YY 

MemberNameZZ 
=ZZ 
$strZZ $
,ZZ$ %
Email[[ 
=[[ 
$str[[ )
,[[) *
Password\\ 
=\\ 
$str\\ #
,\\# $
City]] 
=]] 
$str]] 
,]] 
Country^^ 
=^^ 
$str^^ !
}__ 
,__ 
new`` 
MemberObject`` 
{aa 
MemberIDbb 
=bb 
$numbb 
,bb 

MemberNamecc 
=cc 
$strcc &
,cc& '
Emaildd 
=dd 
$strdd *
,dd* +
Passwordee 
=ee 
$stree #
,ee# $
Cityff 
=ff 
$strff $
,ff$ %
Countrygg 
=gg 
$strgg #
}hh 
}ii 	
;ii	 

privatejj 
	MemberDAOjj 
(jj 
)jj 
{kk 	
MemberObjectll 
DefaultAdminll %
=ll& '
GetDefaultMemberll( 8
(ll8 9
)ll9 :
;ll: ;
ifmm 
(mm 
DefaultAdminmm 
!=mm 
nullmm  $
)mm$ %
{nn 
membersoo 
.oo 
Addoo 
(oo 
DefaultAdminoo (
)oo( )
;oo) *
}pp 
}qq 	
privatett 
statictt 
	MemberDAOtt  
instancett! )
=tt* +
nulltt, 0
;tt0 1
privateuu 
staticuu 
objectuu 
instanceLookuu *
=uu+ ,
newuu- 0
objectuu1 7
(uu7 8
)uu8 9
;uu9 :
publicww 
staticww 
	MemberDAOww 
Instanceww  (
{xx 	
getyy 
{zz 
lock{{ 
({{ 
instanceLook{{ "
){{" #
{|| 
if}} 
(}} 
instance}}  
==}}! #
null}}$ (
)}}( )
{~~ 
instance  
=! "
new# &
	MemberDAO' 0
(0 1
)1 2
;2 3
}
ÄÄ 
return
ÅÅ 
instance
ÅÅ #
;
ÅÅ# $
}
ÇÇ 
}
ÉÉ 
}
ÑÑ 	
public
ÜÜ 
List
ÜÜ 
<
ÜÜ 
MemberObject
ÜÜ  
>
ÜÜ  !
GetMembersList
ÜÜ" 0
=>
ÜÜ1 3
members
ÜÜ4 ;
;
ÜÜ; <
public
àà 
MemberObject
àà 
Login
àà !
(
àà! "
string
àà" (
Email
àà) .
,
àà. /
string
àà0 6
Password
àà7 ?
)
àà? @
{
ââ 	
MemberObject
ää 
member
ää 
=
ää  !
members
ää" )
.
ää) *
SingleOrDefault
ää* 9
(
ää9 :
mb
ää: <
=>
ää= ?
mb
ää@ B
.
ääB C
Email
ääC H
.
ääH I
Equals
ääI O
(
ääO P
Email
ääP U
)
ääU V
&&
ääW Y
mb
ääZ \
.
ää\ ]
Password
ää] e
.
ääe f
Equals
ääf l
(
ääl m
Password
ääm u
)
ääu v
)
ääv w
;
ääw x
return
ãã 
member
ãã 
;
ãã 
}
åå 	
public
éé 
MemberObject
éé 
	GetMember
éé %
(
éé% &
int
éé& )
MemberId
éé* 2
)
éé2 3
{
èè 	
return
êê 
members
êê 
.
êê 
SingleOrDefault
êê *
(
êê* +
mb
êê+ -
=>
êê. 0
mb
êê1 3
.
êê3 4
MemberID
êê4 <
==
êê= ?
MemberId
êê@ H
)
êêH I
;
êêI J
}
ëë 	
public
íí 
MemberObject
íí 
	GetMember
íí %
(
íí% &
string
íí& ,
MemberEmail
íí- 8
)
íí8 9
{
ìì 	
return
îî 
members
îî 
.
îî 
SingleOrDefault
îî *
(
îî* +
mb
îî+ -
=>
îî. 0
mb
îî1 3
.
îî3 4
Email
îî4 9
.
îî9 :
Equals
îî: @
(
îî@ A
MemberEmail
îîA L
)
îîL M
)
îîM N
;
îîN O
}
ïï 	
public
ññ 
void
ññ 
	AddMember
ññ 
(
ññ 
MemberObject
ññ *
member
ññ+ 1
)
ññ1 2
{
óó 	
if
òò 
(
òò 
member
òò 
==
òò 
null
òò 
)
òò 
{
ôô 
throw
öö 
new
öö 
	Exception
öö #
(
öö# $
$str
öö$ ;
)
öö; <
;
öö< =
}
õõ 
if
ùù 
(
ùù 
	GetMember
ùù 
(
ùù 
member
ùù  
.
ùù  !
MemberID
ùù! )
)
ùù) *
==
ùù+ -
null
ùù. 2
&&
ùù3 5
	GetMember
ùù6 ?
(
ùù? @
member
ùù@ F
.
ùùF G
Email
ùùG L
)
ùùL M
==
ùùN P
null
ùùQ U
)
ùùU V
{
ûû 
members
üü 
.
üü 
Add
üü 
(
üü 
member
üü "
)
üü" #
;
üü# $
}
†† 
else
†† 
{
°° 
throw
¢¢ 
new
¢¢ 
	Exception
¢¢ #
(
¢¢# $
$str
¢¢$ 9
)
¢¢9 :
;
¢¢: ;
}
££ 
}
§§ 	
public
•• 
void
•• 
Update
•• 
(
•• 
MemberObject
•• '
member
••( .
)
••. /
{
¶¶ 	
if
ßß 
(
ßß 
member
ßß 
==
ßß 
null
ßß 
)
ßß 
{
®® 
throw
©© 
new
©© 
	Exception
©© #
(
©©# $
$str
©©$ ;
)
©©; <
;
©©< =
}
™™ 
MemberObject
´´ 
mem
´´ 
=
´´ 
	GetMember
´´ (
(
´´( )
member
´´) /
.
´´/ 0
MemberID
´´0 8
)
´´8 9
;
´´9 :
if
¨¨ 
(
¨¨ 
mem
¨¨ 
!=
¨¨ 
null
¨¨ 
)
¨¨ 
{
≠≠ 
var
ÆÆ 
index
ÆÆ 
=
ÆÆ 
members
ÆÆ #
.
ÆÆ# $
IndexOf
ÆÆ$ +
(
ÆÆ+ ,
mem
ÆÆ, /
)
ÆÆ/ 0
;
ÆÆ0 1
members
ØØ 
[
ØØ 
index
ØØ 
]
ØØ 
=
ØØ  
member
ØØ! '
;
ØØ' (
}
∞∞ 
else
∞∞ 
{
±± 
throw
≤≤ 
new
≤≤ 
	Exception
≤≤ #
(
≤≤# $
$str
≤≤$ =
)
≤≤= >
;
≤≤> ?
}
≥≥ 
}
¥¥ 	
public
µµ 
void
µµ 
Delete
µµ 
(
µµ 
int
µµ 
MemberId
µµ '
)
µµ' (
{
∂∂ 	
MemberObject
∑∑ 
member
∑∑ 
=
∑∑  !
	GetMember
∑∑" +
(
∑∑+ ,
MemberId
∑∑, 4
)
∑∑4 5
;
∑∑5 6
if
∏∏ 
(
∏∏ 
member
∏∏ 
!=
∏∏ 
null
∏∏ 
)
∏∏ 
{
ππ 
members
∫∫ 
.
∫∫ 
Remove
∫∫ 
(
∫∫ 
member
∫∫ %
)
∫∫% &
;
∫∫& '
}
ªª 
else
ªª 
{
ºº 
throw
ΩΩ 
new
ΩΩ 
	Exception
ΩΩ #
(
ΩΩ# $
$str
ΩΩ$ =
)
ΩΩ= >
;
ΩΩ> ?
}
ææ 
}
øø 	
public
¡¡ 
IEnumerable
¡¡ 
<
¡¡ 
MemberObject
¡¡ '
>
¡¡' (
SearchMember
¡¡) 5
(
¡¡5 6
int
¡¡6 9
id
¡¡: <
)
¡¡< =
{
¬¬ 	
IEnumerable
√√ 
<
√√ 
MemberObject
√√ $
>
√√$ %
searchResult
√√& 2
=
√√3 4
null
√√5 9
;
√√9 :
var
≈≈ 
memberSearch
≈≈ 
=
≈≈ 
from
≈≈ #
member
≈≈$ *
in
≈≈+ -
members
≈≈. 5
where
∆∆ $
member
∆∆% +
.
∆∆+ ,
MemberID
∆∆, 4
==
∆∆5 7
id
∆∆8 :
select
«« %
member
««& ,
;
««, -
searchResult
»» 
=
»» 
memberSearch
»» '
;
»»' (
return
   
searchResult
   
;
    
}
ÀÀ 	
public
ÃÃ 
IEnumerable
ÃÃ 
<
ÃÃ 
MemberObject
ÃÃ '
>
ÃÃ' (
SearchMember
ÃÃ) 5
(
ÃÃ5 6
string
ÃÃ6 <
name
ÃÃ= A
)
ÃÃA B
{
ÕÕ 	
IEnumerable
ŒŒ 
<
ŒŒ 
MemberObject
ŒŒ $
>
ŒŒ$ %
searchResult
ŒŒ& 2
=
ŒŒ3 4
null
ŒŒ5 9
;
ŒŒ9 :
var
–– 
memberSearch
–– 
=
–– 
from
–– #
member
––$ *
in
––+ -
members
––. 5
where
—— $
member
——% +
.
——+ ,

MemberName
——, 6
.
——6 7
ToLower
——7 >
(
——> ?
)
——? @
.
——@ A
Contains
——A I
(
——I J
name
——J N
.
——N O
ToLower
——O V
(
——V W
)
——W X
)
——X Y
select
““ %
member
““& ,
;
““, -
searchResult
”” 
=
”” 
memberSearch
”” '
;
””' (
return
’’ 
searchResult
’’ 
;
’’  
}
÷÷ 	
public
ÿÿ 
IEnumerable
ÿÿ 
<
ÿÿ 
MemberObject
ÿÿ '
>
ÿÿ' (#
FilterMemberByCountry
ÿÿ) >
(
ÿÿ> ?
string
ÿÿ? E
country
ÿÿF M
,
ÿÿM N
IEnumerable
ÿÿO Z
<
ÿÿZ [
MemberObject
ÿÿ[ g
>
ÿÿg h

searchList
ÿÿi s
)
ÿÿs t
{
ŸŸ 	
IEnumerable
⁄⁄ 
<
⁄⁄ 
MemberObject
⁄⁄ $
>
⁄⁄$ %
searchResult
⁄⁄& 2
=
⁄⁄3 4
null
⁄⁄5 9
;
⁄⁄9 :
var
‹‹ 
memberSearch
‹‹ 
=
‹‹ 
from
‹‹ #
member
‹‹$ *
in
‹‹+ -

searchList
‹‹. 8
where
›› $
member
››% +
.
››+ ,
Country
››, 3
==
››4 6
country
››7 >
select
ﬁﬁ %
member
ﬁﬁ& ,
;
ﬁﬁ, -
if
ﬂﬂ 
(
ﬂﬂ 
country
ﬂﬂ 
.
ﬂﬂ 
Equals
ﬂﬂ 
(
ﬂﬂ 
$str
ﬂﬂ $
)
ﬂﬂ$ %
)
ﬂﬂ% &
{
‡‡ 
memberSearch
·· 
=
·· 
from
·· #
member
··$ *
in
··+ -

searchList
··. 8
select
‚‚ %
member
‚‚& ,
;
‚‚, -
}
„„ 
searchResult
‰‰ 
=
‰‰ 
memberSearch
‰‰ '
;
‰‰' (
return
ÊÊ 
searchResult
ÊÊ 
;
ÊÊ  
}
ÁÁ 	
public
ÈÈ 
IEnumerable
ÈÈ 
<
ÈÈ 
MemberObject
ÈÈ '
>
ÈÈ' ( 
FilterMemberByCity
ÈÈ) ;
(
ÈÈ; <
string
ÈÈ< B
country
ÈÈC J
,
ÈÈJ K
string
ÈÈL R
city
ÈÈS W
,
ÈÈW X
IEnumerable
ÈÈY d
<
ÈÈd e
MemberObject
ÈÈe q
>
ÈÈq r

searchList
ÈÈs }
)
ÈÈ} ~
{
ÍÍ 	
IEnumerable
ÎÎ 
<
ÎÎ 
MemberObject
ÎÎ $
>
ÎÎ$ %
searchResult
ÎÎ& 2
=
ÎÎ3 4
null
ÎÎ5 9
;
ÎÎ9 :
var
ÌÌ 
memberSearch
ÌÌ 
=
ÌÌ 
from
ÌÌ #
member
ÌÌ$ *
in
ÌÌ+ -

searchList
ÌÌ. 8
where
ÓÓ $
member
ÓÓ% +
.
ÓÓ+ ,
City
ÓÓ, 0
==
ÓÓ1 3
city
ÓÓ4 8
select
ÔÔ %
member
ÔÔ& ,
;
ÔÔ, -
if
 
(
 
city
 
.
 
Equals
 
(
 
$str
 !
)
! "
)
" #
{
ÒÒ 
memberSearch
ÚÚ 
=
ÚÚ 
from
ÚÚ #
member
ÚÚ$ *
in
ÚÚ+ -

searchList
ÚÚ. 8
where
ÛÛ $
member
ÛÛ% +
.
ÛÛ+ ,
Country
ÛÛ, 3
==
ÛÛ4 6
country
ÛÛ7 >
select
ÙÙ %
member
ÙÙ& ,
;
ÙÙ, -
if
ıı 
(
ıı 
country
ıı 
.
ıı 
Equals
ıı "
(
ıı" #
$str
ıı# (
)
ıı( )
)
ıı) *
{
ˆˆ 
memberSearch
˜˜  
=
˜˜! "
from
˜˜# '
member
˜˜( .
in
˜˜/ 1

searchList
˜˜2 <
select
¯¯# )
member
¯¯* 0
;
¯¯0 1
}
˘˘ 
}
˙˙ 
searchResult
˚˚ 
=
˚˚ 
memberSearch
˚˚ '
;
˚˚' (
return
˝˝ 
searchResult
˝˝ 
;
˝˝  
}
˛˛ 	
}
ˇˇ 
}ÄÄ æ
•E:\FPTU\PhongNT-FPTU-Learning-Resources\2021_Semester5_SUMMER\PRN211\Code Project\Assignments\Assigment01_MemberManagement\DataAccess\Repository\IMemberRepository.cs
	namespace 	

DataAccess
 
. 

Repository 
{		 
public

 

	interface

 
IMemberRepository

 &
{ 
public 
IEnumerable 
< 
MemberObject '
>' (
GetMembersList) 7
(7 8
)8 9
;9 :
public 
MemberObject 
Login !
(! "
string" (
Email) .
,. /
String0 6
Password7 ?
)? @
;@ A
public 
void 
	AddMember 
( 
MemberObject *
member+ 1
)1 2
;2 3
public 
void 
UpdateMember  
(  !
MemberObject! -
member. 4
)4 5
;5 6
public 
void 
DeleteMember  
(  !
int! $
MemberID% -
)- .
;. /
public 
IEnumerable 
< 
MemberObject '
>' (
SearchMember) 5
(5 6
int6 9
id: <
)< =
;= >
public 
IEnumerable 
< 
MemberObject '
>' (
SearchMember) 5
(5 6
string6 <
name= A
)A B
;B C
public 
IEnumerable 
< 
MemberObject '
>' (!
SearchMemberByCountry) >
(> ?
string? E
countryF M
,M N
IEnumerableO Z
<Z [
MemberObject[ g
>g h

searchListi s
)s t
;t u
public 
IEnumerable 
< 
MemberObject '
>' (
SearchMemberByCity) ;
(; <
string< B
countryC J
,J K
stringL R
cityS W
,W X
IEnumerableY d
<d e
MemberObjecte q
>q r

searchLists }
)} ~
;~ 
} 
} Î 
§E:\FPTU\PhongNT-FPTU-Learning-Resources\2021_Semester5_SUMMER\PRN211\Code Project\Assignments\Assigment01_MemberManagement\DataAccess\Repository\MemberRepository.cs
	namespace 	

DataAccess
 
. 

Repository 
{		 
public

 

class

 
MemberRepository

 !
:

" #
IMemberRepository

$ 5
{ 
public 
void 
	AddMember 
( 
MemberObject *
member+ 1
)1 2
=>3 5
	MemberDAO6 ?
.? @
Instance@ H
.H I
	AddMemberI R
(R S
memberS Y
)Y Z
;Z [
public 
void 
DeleteMember  
(  !
int! $
MemberID% -
)- .
=>/ 1
	MemberDAO2 ;
.; <
Instance< D
.D E
DeleteE K
(K L
MemberIDL T
)T U
;U V
public 
IEnumerable 
< 
MemberObject '
>' (
GetMembersList) 7
(7 8
)8 9
{ 	
return 
	MemberDAO 
. 
Instance %
.% &
GetMembersList& 4
;4 5
} 	
public 
IEnumerable 
< 
MemberObject '
>' (
SearchMember) 5
(5 6
int6 9
id: <
)< =
{ 	
return 
	MemberDAO 
. 
Instance %
.% &
SearchMember& 2
(2 3
id3 5
)5 6
;6 7
} 	
public 
IEnumerable 
< 
MemberObject '
>' (
SearchMember) 5
(5 6
string6 <
name= A
)A B
{ 	
return 
	MemberDAO 
. 
Instance %
.% &
SearchMember& 2
(2 3
name3 7
)7 8
;8 9
} 	
public 
MemberObject 
Login !
(! "
string" (
Email) .
,. /
string0 6
Password7 ?
)? @
{ 	
return 
	MemberDAO 
. 
Instance %
.% &
Login& +
(+ ,
Email, 1
,1 2
Password3 ;
); <
;< =
}   	
public$$ 
void$$ 
UpdateMember$$  
($$  !
MemberObject$$! -
member$$. 4
)$$4 5
=>$$6 8
	MemberDAO$$9 B
.$$B C
Instance$$C K
.$$K L
Update$$L R
($$R S
member$$S Y
)$$Y Z
;$$Z [
public&& 
IEnumerable&& 
<&& 
MemberObject&& '
>&&' (!
SearchMemberByCountry&&) >
(&&> ?
string&&? E
country&&F M
,&&M N
IEnumerable&&O Z
<&&Z [
MemberObject&&[ g
>&&g h

searchList&&i s
)&&s t
{'' 	
return(( 
	MemberDAO(( 
.(( 
Instance(( %
.((% &!
FilterMemberByCountry((& ;
(((; <
country((< C
,((C D

searchList((E O
)((O P
;((P Q
})) 	
public++ 
IEnumerable++ 
<++ 
MemberObject++ '
>++' (
SearchMemberByCity++) ;
(++; <
string++< B
country++C J
,++J K
string++L R
city++S W
,++W X
IEnumerable++Y d
<++d e
MemberObject++e q
>++q r

searchList++s }
)++} ~
{,, 	
return-- 
	MemberDAO-- 
.-- 
Instance-- %
.--% &
FilterMemberByCity--& 8
(--8 9
country--9 @
,--@ A
city--B F
,--F G

searchList--H R
)--R S
;--S T
}.. 	
}// 
}00 